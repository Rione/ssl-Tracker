/*
 * Copyright (c) 2009 - 2021, DHBW Mannheim - TIGERs Mannheim
 */

plugins {
    id 'com.google.protobuf'
}

protobuf {
    protoc {
        artifact = 'com.google.protobuf:protoc:3.23.2'
    }
    // See: https://github.com/protocolbuffers/protobuf/issues/7271
    generateProtoTasks {
        all().each { task ->
            task.doLast {
                ant.replaceregexp(
                        match: '@java.lang.Deprecated|@deprecated',
                        replace: '',
                        flags: 'g',
                        byline: true
                ) {
                    fileset(
                            dir: "${protobuf.generatedFilesBaseDir}/main/java")
                }
            }
        }
    }
}
